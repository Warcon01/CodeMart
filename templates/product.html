<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Product.Name}} - CodeMart</title>
    <!-- Bootstrap & Custom Product CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/product.css">
</head>
<body>

<!-- Header -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm py-3">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex flex-grow-1"></div>

        <div class="text-center flex-grow-1">
            <a class="navbar-brand fw-bold fs-3 text-dark" href="/">CodeMart<span class="fs-5">â„¢</span></a>
        </div>

        <div class="d-flex align-items-center">
            {{if .IsLoggedIn}}
            <a class="btn btn-outline-secondary me-2" href="/profile">ðŸ‘¤ Profile</a>
            {{else}}
            <a class="btn btn-outline-secondary me-2" href="/login">ðŸ”‘ Login</a>
            {{end}}
            <a class="btn btn-outline-primary me-2" href="/basket">ðŸ›’ Cart</a>
            <a class="btn btn-warning fw-bold" href="/checkout">âœ… Checkout</a>
        </div>
    </div>
</nav>

<!-- Product Details -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6 text-center">
            <img src="{{.Product.ImageURL}}" class="product-detail-image" alt="{{.Product.Name}}">
        </div>
        <div class="col-md-6">
            <h1 class="fw-bold">{{.Product.Name}}</h1>
            <h3 class="text-primary">{{.Product.Price}}â‚¸</h3>
            <p class="mt-3">{{.Product.Description}}</p>

            <form action="/cart/add" method="POST" class="mt-4">
                <input type="hidden" name="product_id" value="{{.Product.ID}}">
                <label for="quantity" class="fw-bold">Quantity:</label>
                <input type="number" name="quantity" id="quantity" min="1" value="1" class="form-control w-25">
                <button id="add-to-cart" class="btn btn-primary"
                        data-productid="{{.Product.ID}}"
                        data-name="{{.Product.Name}}"
                        data-price="{{.Product.Price}}"
                        data-quantity="quantity">
                    Add to Cart
                </button>

            </form>

            <a href="/" class="btn btn-secondary mt-3">ðŸ”™ Back to Home</a>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="footer text-center bg-white text-dark py-3 mt-5 shadow-sm">
    <p class="mb-0">Â© 2025. Made by <b>Adi M.</b> | <b>Vladislav Z.</b> | <b>Abzal O.</b></p>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("add-to-cart").addEventListener("click", function(event) {
            event.preventDefault(); // ÐŸÑ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ Ñ„Ð¾Ñ€Ð¼Ñ‹

            let productID = this.dataset.productid;
            let name = this.dataset.name;
            let price = this.dataset.price;
            let quantity = document.getElementById("quantity").value; // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð¸Ð½Ð¿ÑƒÑ‚Ð°

            fetch('/api/cart/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: `product_id=${productID}&name=${name}&price=${price}&quantity=${quantity}`
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "success") {
                        alert("Added to cart successfully!");
                    } else {
                        alert("Failed to add item to cart.");
                    }
                })
                .catch(error => console.error("Error:", error));
        });
    });
</script>


</body>
</html>
